# Вариативная часть: Мониторинг и безопасность сетевого трафика с использованием сниффера

В ходе учебной практики было проведено исследование по теме мониторинга и безопасности сетевого трафика с применением инструментов анализа пакетов. Основная цель работы — продемонстрировать, как при помощи снифферов можно перехватывать сетевые данные, выявлять потенциальные уязвимости и понимать механизмы атак типа Man-in-the-Middle (MITM). В рамках исследования были рассмотрены два практических случая, реализованных с использованием двух виртуальных машин: Kali Linux и Parrot OS.

**Оборудование и программное обеспечение**  
Kali Linux — используется для запуска инструментов перехвата и анализа трафика.  
Parrot OS — служит клиентской машиной с веб-сервером для тестирования.  
Wireshark — графический сниффер для захвата и анализа сетевых пакетов.  
mitmproxy — инструмент для организации MITM-атаки и перехвата HTTPS-трафика.  
login.html — простой HTML-файл с формой логина и пароля, размещённый на Parrot OS.  
server.py — простой сервер на Python, обрабатывающий запросы от клиента и взаимодействующий с login.html.

Для обеспечения работы веб-формы login.html на Parrot OS был разработан скрипт _server.py_. Он запускает локальный HTTP-сервер, который принимает POST-запросы с данными логина и пароля и возвращает простую страницу с подтверждением входа.

Код _server.py_ использует модуль http.server с переопределением методов для обработки входящих данных формы. Это позволяет эмулировать работу сервера и получить полноценный трафик для анализа сниффером и MITM-инструментом.

![1](images/1.png)

---

![2](images/2.png)

---

### Сценарий 1: перехват учетных данных с помощью Wireshark

В первом эксперименте был развернут простой HTTP-сервер на Kali, обрабатывающий форму входа. Веб-интерфейс был реализован через HTML-страницу login.html, содержащую поля для логина и пароля. Серверная часть на Python, принимала данные формы и отображала их в консоли.  
С Parrot OS в браузере открывалась эта веб-страница, после чего вводились тестовые данные.

![3](images/3.png)

---
  
![4](images/4.png)
  
Одновременно на Kali запускался сниффер Wireshark, который прослушивал интерфейс и фильтровал HTTP-трафик.

![5](images/5.png)

При отправке формы удалось захватить POST-запрос, содержащий переданные логин и пароль в открытом виде.

![6](images/6.png)
 
Это наглядно продемонстрировало, насколько небезопасна передача данных без использования HTTPS.  
Если бы веб-страница использовала HTTPS вместо HTTP, трафик между клиентом (Parrot OS) и сервером (Kali) передавался бы в зашифрованном виде. В этом случае Wireshark смог бы зафиксировать сам факт соединения и базовую информацию о TLS-сеансе (например, домен, используемый сертификат, параметры шифрования), но содержимое запроса - такие как логин и пароль - осталось бы недоступным.

### Сценарий 2: атака Man-in-the-Middle с использованием mitmproxy

Во втором эксперименте осуществлялась MITM-атака с помощью утилиты mitmproxy. В этом случае сервер с формой входа был размещён на Parrot OS, а весь трафик принудительно перенаправлялся через Kali, где был запущен прокси на порту 8080.

![7](images/7.png)
  
На стороне жертвы в браузере вручную задавались настройки прокси и устанавливался сертификат mitmproxy, позволяющий перехватывать даже HTTPS-трафик без предупреждений.

![8](images/8.png)

![9](images/9.png)
 
![10](images/10.png)
  

После этого происходил вход на сайт, и все данные успешно отображались в интерфейсе mitmproxy на Kali - включая логины, пароли и передаваемые заголовки.

![11](images/11.png)

![12](images/12.png)

### Заключение

В ходе практической работы были рассмотрены два сценария перехвата сетевого трафика с использованием сниффера и MITM-атаки. Первый случай показал, насколько уязвимы незащищенные HTTP-соединения — передаваемые данные (например, логин и пароль) можно легко перехватить в открытом виде с помощью инструментов анализа трафика, таких как Wireshark. Это подчёркивает важность обязательного использования HTTPS для всех веб-сервисов, особенно тех, что обрабатывают конфиденциальную информацию.  
Во втором сценарии удалось провести MITM-атаку с помощью mitmproxy - трафик HTTPS был успешно расшифрован благодаря вручную установленному поддельному сертификату на клиентской системе. Несмотря на успешную демонстрацию, стоит отметить, что такой метод перехвата сложно реализуем в реальных условиях без доступа к устройству пользователя или вмешательства в сетевую инфраструктуру. Тем не менее, он подчеркивает необходимость защиты на уровне доверенных сертификатов, использования механизмов вроде certificate pinning, а также ограничения возможности установки сторонних корневых сертификатов.  
Оба случая продемонстрировали, что надежная защита сетевого трафика должна включать не только использование шифрования, но и меры по защите от MITM-атак. Современные системы должны обеспечивать целостность соединения, надежную проверку подлинности сертификатов и контролировать сетевую активность. Такие подходы критически важны для безопасности как частных пользователей, так и корпоративных решений.
